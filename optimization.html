---

title: Optimization


keywords: fastai
sidebar: home_sidebar

summary: "Let's leave the physics simulator out of it for now..."
description: "Let's leave the physics simulator out of it for now..."
nb_path: "notebooks/06_optimization.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks/06_optimization.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data">Data<a class="anchor-link" href="#Data"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="target">target<a class="anchor-link" href="#target"> </a></h3><p>Let's - for now - just try to find a pre-defined design target (which we will construct with out generator)...</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">brush_target</span> <span class="o">=</span> <span class="n">notched_square_brush</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">latent_target</span> <span class="o">=</span> <span class="n">new_latent_design</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">latent_target_t</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">latent_target</span><span class="p">,</span> <span class="n">brush_target</span><span class="p">)</span>
<span class="n">design_target</span> <span class="o">=</span> <span class="n">generate_feasible_design</span><span class="p">(</span><span class="n">latent_target_t</span><span class="p">,</span> <span class="n">brush_target</span><span class="p">)</span>
<span class="n">mask_target</span> <span class="o">=</span> <span class="n">design_mask</span><span class="p">(</span><span class="n">design_target</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mask_target</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greys_r&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>WARNING:absl:No GPU/TPU found, falling back to CPU. (Set TF_CPP_MIN_LOG_LEVEL=0 and rerun for more info.)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATwAAAD8CAYAAADqmhgGAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAWMElEQVR4nO3dfYxc1X3G8e9TA6pCUAsxL8bYMY2sqjQqTryCRESNaTAyVlKHqkS2KnBTUocKSyGKqliJFJCiSiivbRSKuxALIgUoFThYqRMwVionjRJ5F7lg4zi4rgOOLZsFFKA0QrZ//WPOkrszszN3du7cebnPRxrtvee+nb27+9tz7rnnHEUEZmZV8Dv9zoCZWVkc8MysMhzwzKwyHPDMrDIc8MysMhzwzKwyHPDMrGckbZF0QtLeWbZL0jckHZT0tKT3ZratknQgbdtURH4c8Mysl+4DVrXYfh2wNH02AHcDSJoH3JW2Xwask3RZt5lxwDOznomIXcDLLXZZA3w7an4K/L6kBcAVwMGIOBQRbwIPpX27cka3J+jE/PnzY8mSJWVesmcmJyf7nQUbcsuXLy/8nIcPH2ZqakrdnGPVqlUxNTWVa9/Jycl9wG8ySeMRMd7B5RYCL2TWj6S0ZulXdnDeproKeJJWAf8EzAPujYg7W+2/ZMkSJiYmurnkwJC6+p0y68nfwtjYWNfnmJqayp03Sb+JiG4u2uwPKVqkd2XOAS9Tx15JLfrulrQtIp7tNlNm1l8l9rE/AizKrF8CHAXOmiW9K908w+tJHdvMKmUbcFNqrX0f8OuIOAbsBpZKulTSWcDatG9XuqnS5qpjS9pArfWFxYsXd3E5MytLUSU8SQ8CK4D5ko4AtwNnpmtsBrYDq4GDwBvAx9O2k5I2Ao9Te2S2JSL2dZufbgJerjp2eoA5DjA2NuaxqMyGQFEBLyLWtdkewK2zbNtOLSAWppsq7Wx1bzOzgdRNwOtJHdvM+isicn+GzZyrtL2qY5uZ9UpX7+H1oo5tZv03jKW3PNy1zMwqo9SuZWY2HEa1hOeAZ2YNRjXguUprZpXhEp6ZNRjVEp4DXgseEcW6NaqBY1g54JnZDMP6UnEefoZnZpXhEp6ZNXAJz8xsyLmEZ2YNXMIzMxtyLuGZdWkUS0Oj+D2BA56ZNTGqAc9VWjPrKUmrJB2QdFDSpibb/17SnvTZK+mUpPPStsOSnknbup7X0iU8M5uhyBeP80znGhFfBr6c9v8I8OmIeDlzmqsjIt/M4G24hGdmvdTpdK7rgAd7lRkHPDNrUOCcFs2mc13YbEdJbwNWAY9kswI8IWkyTfnaFVdpzaxBB1Xa+XXP1sbT1KzTck3nmnwE+M+66uxVEXFU0gXADkk/j4hdeTNXzwHPzBp0EPCmImKsxfZOpnNdS111NiKOpq8nJG2lVkWec8BzldbMeinXdK6Sfg/4IPBYJu1sSedMLwPXAnu7yYxLeGY2Q5GttLNN5yrplrR9c9r1euCJiPjfzOEXAlvTuJRnAA9ExA+6yY8Dnpk1KPLF42bTuWYC3fT6fcB9dWmHgMsLywgOeGbWxKj2tHDAM7MGDnhmVhmjGvDcSmtmldFVCU/SYeA14BRwss37OGY2BEZ5Ep8iqrSFdew1s8HggGdmlTGqAa/bZ3htO/ZK2iBpQtLEiy++2OXlzKwMBQ4eMFC6LeG17dibOhKPA4yNjQ3fHTKroGEMZnl0VcLLduwFpjv2mpkNpDkHvF507DWz/stbnR3GUmA3VdrCO/YOmlY/0PR9l2rQfsH6cQ+sHIP2u1aUOQe8XnTsNbPB4IBnZpXhgGdmlTGqAc99ac2sMlzCM7MZhrUFNg8HPDNrcPr06X5noScc8OZoVP8DdqLdPfBrKzZo/AzPzBoU+eKxpFWSDkg6KGlTk+0rJP1a0p70+ULeYzvlEp6ZNSiqBiNpHnAXsJLaHLW7JW2LiGfrdv1RRHx4jsfm5hKemfXSFcDBiDgUEW8CDwFrSji2KQc8M5uhw76086eHf0uf+mHiFgIvZNaPpLR675f0X5K+L+mPOzw2N1dpzaxBB620U22mdmjWclVfX34KeGdEvC5pNfBdYGnOYzviEp6ZNSiw0eIIsCizfglwtO5ar0bE62l5O3CmpPl5ju2UA56ZNSgw4O0Glkq6VNJZwFpgW3YHSRcpvcMk6QpqcemlPMd2ylVaM5uhyJ4WEXFS0kbgcWAesCUi9km6JW3fDPwl8HeSTgL/B6yNWgaaHttNfhzwzKynUjV1e13a5szyN4Fv5j22Gw54ZtZgVHsSOeCZWQP3pTWzynAJz8wqwcNDmVmlOOCZWWU44JlZZTjgmVllOOCZWSW40cLMKsUBz8wqwwHPzCpjVANe2+GhJG2RdELS3kzaeZJ2SHoufT23t9k0s7JEBKdPn871GTZ5xsO7D1hVl7YJ2BkRS4Gdad3MbKC1DXgRsQt4uS55DXB/Wr4f+Gix2TKzfipymsZBMtdneBdGxDGAiDgm6YLZdkyTemwAWLx48RwvZ2ZlGsZglkfPh3iPiPGIGIuIsfPPP7/XlzOzAoxqCW+uAe+4pAUA6euJ4rJkZv3mgDfTNmB9Wl4PPFZMdsys34pupZW0StIBSQclNTRwSvorSU+nz08kXZ7ZdljSM5L2SJro9ntr+wxP0oPACmoT7h4BbgfuBB6WdDPwPHBDtxkxs8FRVOlN0jzgLmAltWkXd0vaFhHPZnb7H+CDEfGKpOuAceDKzParI2KqiPy0DXgRsW6WTR8qIgNmNtKuAA5GxCEASQ9Re8vjrYAXET/J7P9TavPP9oTnpTWzBh08w5svaSLz2VB3qoXAC5n1IyltNjcD389mBXhC0mSTc3fMXcvMbIbpZ3g5TUXEWIvtanaJpjtKV1MLeB/IJF8VEUfTq287JP08vRs8Jy7hmVmDAhstjgCLMuuXAEfrd5L0J8C9wJqIeGk6PSKOpq8ngK3Uqshz5oBnZg0KfC1lN7BU0qWSzgLWUnvL4y2SFgOPAjdGxC8y6WdLOmd6GbgW2EsXXKU1sxk6rNK2O9dJSRuBx4F5wJaI2CfplrR9M/AF4B3AP0sCOJmqyRcCW1PaGcADEfGDbvLjgGdmDYp8qTgitgPb69I2Z5Y/AXyiyXGHgMvr07vhgGdmDYaxF0UeDnhm1sABz8wqISI4depUv7PREw54ZtbAJTwzqwwHPDOrDAe8Ckrv/xRqlH6RenF/hlGr+zCMP+8i38MbNA54ZtbAAc/MKmMYS6Z5OOCZ2QzDOnx7Hg54ZtbAVVozqwyX8MysMhzwzKwS3LVsiA3au2K9yk+v/iMP2v0bNsN6/1zCM7NKcCutmVWKA56ZVcaoBjxP4mNmDQqctQxJqyQdkHRQ0qYm2yXpG2n705Lem/fYTjngmdkM04MHFBHwJM0D7gKuAy4D1km6rG6364Cl6bMBuLuDYzvigGdmDQqcpvEK4GBEHIqIN4GHgDV1+6wBvh01PwV+X9KCnMd2pNRneJOTk0PbTD/ofF+tSB10LZsvaSKzPh4R45n1hcALmfUjwJV152i2z8Kcx3akbcCTtAX4MHAiIt6d0u4A/hZ4Me32uTQVm5kNuQ5fS5lKc8jOptl/4vqTz7ZPnmM7kqdKex+wqkn61yNiWfo42JmNkAKrtEeARZn1S4CjOffJc2xH2ga8iNgFvNzNRcxsuBTYSrsbWCrpUklnAWuBbXX7bANuSq217wN+HRHHch7bkW6e4W2UdBMwAXwmIl5ptpOkDdRaXsxsSBT1Hl5EnJS0EXgcmAdsiYh9km5J2zcD24HVwEHgDeDjrY7tJj9zDXh3A1+kVp/+IvBV4G+a7ZgeYI4DSBrNtxnNRkjRXcvSI6/tdWmbM8sB3Jr32G7MKeBFxPHpZUn3AN8rKkNm1n/uaZGR3pGZdj2wt5jsmNkgKLDRYqDkeS3lQWAFtfdtjgC3AyskLaNWpT0MfLJ3WTSzsg1jMMujbcCLiHVNkr/Vg7yY2QDwAKBmVimVLeGZWfU44JlZZTjgmVklDGsLbB4OeGbWwAHPzCqjg+GhhooDnpk1cAnPzCpheoj3UeSAZ2YNXMIzs8pwwDOzSnCV1swqxSU8syHQiz/UKs4I54BnZpUxqgHPE3GbWYMyBgCVdJ6kHZKeS1/PbbLPIkk/lLRf0j5Jn8psu0PSryTtSZ/V7a7pgGdmM+QNdgWUAjcBOyNiKbAzrdc7SW2SsD8C3gfcKumyzPaOpot1wDOzBqdOncr16dIa4P60fD/w0fodIuJYRDyVll8D9gML53pBBzwza9BBCW++pInMp5MpWS9M88+Svl7QamdJS4D3AD/LJG+U9LSkLc2qxPXcaGFmM3RYXZ2KiLHZNkp6ErioyabPd5InSW8HHgFui4hXU3Lu6WKnOeDZUOlH62G7a47iaysFTsR9zWzbJB2XtCAijqWZEE/Mst+Z1ILddyLi0cy5O54u1lVaM2tQUqPFNmB9Wl4PPFa/g2r/Tb4F7I+Ir9Vt63i6WAc8M2tQUsC7E1gp6TlgZVpH0sWSpltcrwJuBP6syesnX5L0jKSngauBT7e7oKu0ZjZDWX1pI+Il4ENN0o8Cq9Pyj4Gmzwwi4sZOr+mAZ2YNRrWnhQOemTVwwDOzynDAMyvJqP6xDZNR/Rm0baWdrfNuno6/ZjZ8phst8nyGTZ7XUmbrvJun46+ZDaGSXkspXduA16LzbtuOv2Y2nEY14HX0DK+u8+6Mjr+Smnb8TZ2JO+lQbGZ9NozBLI/cAa++827e/oMRMQ6Mp3OM5l00GyHDWnrLI1fXslk67x6f7svWquOvmQ2fUa3S5mmlna3zbtuOv2Y2nKrcSjtb592mHX9bWb58eUfDRw/zfxJrzT/rwTaqf5dtn+G16rxLk46/ZjbchjWY5eGeFmbWwAHPzCrDAc/MKiEiipiRbCA54JlZA5fwzKwyHPD6rNUPYBRnjRoFo/pHUwVl/OwknQf8K7AEOAx8LCJeabLfYeA14BRwcnpayLzHZ3kSHzNrUNJ7eJ2MuHR1RCyLmXPgdjxikwOemc1QYoeAbkdc6vj4oanSmll5Oug2Nl/SRGZ9PA0YkkeuEZeAAJ5Ig4/8S+b8eY9/iwOemTXooPQ2VVfNnEHSk8BFTTZ9voPsXBURR1NA2yHp5xGxq4Pj3+KAZ2YzTA/xXtC5rpltm6Tjkhak0tmsIy5FbZ5aIuKEpK3AFcAu0ohN7Y7P8jM8M2tQ0jO8tiMuSTpb0jnTy8C1wN68x9cbiRLeXG+8X2exIoziK1MlDf10J/CwpJuB54EbACRdDNwbEauBC4Gt6T6eATwQET9odXwrIxHwzKw4ZY2WEhEv0WTEpVSFXZ2WDwGXd3J8Kw54ZtbAfWnNrDJGtZeMA56ZzVBkK+2gccAzswYu4ZlZZbiEN4La/Rcb1lcKbHAM4ysrrtKaWaU44JlZZfgZnplVgqu0ZlYpLuGZWWU44JlZJXiaRjOrlFF9htd2PDxJiyT9UNJ+SfskfSql3yHpV5L2pM/q3me3XJ2M7V/gGGFDw/ehO3P9/Wr1Wb58eal5GzZ5Sngngc9ExFNpIL5JSTvStq9HxFd6lz0zK1ulW2nTJBnTE2W8Jmk/sLDXGTOz/hnG0lseHQ3xLmkJ8B7gZylpo6SnJW2RdO4sx2yQNCFp4sUXX+wut2ZWilGt0uYOeJLeDjwC3BYRrwJ3A+8CllErAX612XERMR4RYxExdv7553efYzPrqelW2jyfYZMr4Ek6k1qw+05EPAoQEccj4lREnAbuoTaTkJmNgNOnT+f6dEPSeZJ2SHoufW2oJUr6w0zD6B5Jr0q6LW3ruOE0TyutgG8B+yPia5n0BZndrue3MwmZ2ZArqUq7CdgZEUuBnWm9Ph8HImJZRCwDlgNvAFszu3x9entEbG93wTyttFcBNwLPSNqT0j4HrJO0jNqs4IeBT+Y4VyUM47MNs2klPp9bA6xIy/cD/wF8tsX+HwL+OyJ+OdcL5mml/THQbOCuttHUzIZTSa+lXJjeAiFqk2lf0Gb/tcCDdWkbJd0ETFB7fe6VVifwRNxm1qCDZ3jzp9/CSJ8N2fNIelLS3iafNZ3kR9JZwJ8D/5ZJztVwmuWuZWY2Q4dV2qmIGGtxrmtm2ybpuKQFqXS3ADjR4jrXAU9FxPHMud9alnQP8L12mXUJz8walNRosQ1Yn5bXA4+12HcdddXZuTScuoRnZg1KeoZ3J/CwpJuB54EbACRdDNwbEavT+tuAlTQ2jH6p04ZTBzwza1BGK21EvESt5bU+/SiwOrP+BvCOJvvd2Ok1HfDMbIZh7TaWhwOemTWo7GgpZlY9LuGZWSVUejw8M6sel/DMrDIc8MysMhzwzKwS/AzPzCrFAc/MKsNVWjOrDAc8M6sEdy0zs0rxMzwzqwwHPDOrBFdpzaxSHPDMrDIc8MysMhzwzKwSIoJTp071Oxs94VnLzKxBGbOWSbpB0j5JpyXNOtWjpFWSDkg6KGlTJv08STskPZe+ntvumg54ZtagpGka9wJ/AeyabQdJ84C7qM1LexmwTtJlafMmYGdELAV2pvWWHPDMrEEZAS8i9kfEgTa7XQEcjIhDEfEm8BCwJm1bA9yflu8HPtrumqU+w5ucnJyS9MtM0nxgqsw8tOH8tDZo+YHBy1O/8/POAs7xOLXvI4/flTSRWR+PiPEC8jBtIfBCZv0IcGVavjAijgFExDFJF7Q7WakBLyLOz65LmoiIWevuZXN+Whu0/MDg5WnQ8jMXEbGqqHNJehK4qMmmz0fEY3lO0SRtzkVLt9KaWc9ExDVdnuIIsCizfglwNC0fl7Qgle4WACfanczP8MxskO0Glkq6VNJZwFpgW9q2DVifltcDbUuM/Q54Rdb1i+D8tDZo+YHBy9Og5WdgSbpe0hHg/cC/S3o8pV8saTtARJwENlJ7rrgfeDgi9qVT3AmslPQcsDKtt77mqL5RbWZWr98lPDOz0jjgmVll9CXgzdZVpF8kHZb0jKQ9de8UlZmHLZJOSNqbSeu460yP83OHpF+l+7RH0uoS87NI0g8l7U/dkT6V0vtyj1rkp2/3yNor/Rle6iryC2oPGY9Qa4VZFxHPlpqRmXk6DIxFRN9eGJX0p8DrwLcj4t0p7UvAyxFxZ/rHcG5EfLaP+bkDeD0ivlJGHuryswBYEBFPSToHmKT2Zv1f04d71CI/H6NP98ja60cJr1VXkcqKiF3Ay3XJHXed6XF++iYijkXEU2n5NWotdgvp0z1qkR8bYP0IeM26ivT7FyWAJyRNStrQ57xkzeg6A7TtOlOCjZKeTlXe0qrYWZKWAO8BfsYA3KO6/MAA3CNrrh8Br9CuIgW5KiLeS21EhltTdc4a3Q28C1gGHAO+WnYGJL0deAS4LSJeLfv6OfLT93tks+tHwGvVVaQvIuJo+noC2Eqt2j0IjqdnRdPPjNp2nemliDgeEaci4jRwDyXfJ0lnUgsu34mIR1Ny3+5Rs/z0+x5Za/0IeK26ipRO0tnpoTOSzgaupTZO1yDouOtML00HluR6SrxPkgR8C9gfEV/LbOrLPZotP/28R9ZeX3papKb6fwTmAVsi4h9Kz8Rv8/IH1Ep1UBtM4YF+5EfSg8AKasPyHAduB74LPAwsBp4HboiIUhoSZsnPCmpVtQAOA5+cfn5WQn4+APwIeAaYnjT1c9Sem5V+j1rkZx19ukfWnruWmVlluKeFmVWGA56ZVYYDnplVhgOemVWGA56ZVYYDnplVhgOemVXG/wPBcwq8h0QAywAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="input">input<a class="anchor-link" href="#input"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">brush_input</span> <span class="o">=</span> <span class="n">notched_square_brush</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">latent_input</span> <span class="o">=</span> <span class="n">new_latent_design</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">latent_input_t</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">latent_input</span><span class="p">,</span> <span class="n">brush_input</span><span class="p">)</span>
<span class="n">design_input</span> <span class="o">=</span> <span class="n">generate_feasible_design</span><span class="p">(</span><span class="n">latent_input_t</span><span class="p">,</span> <span class="n">brush_target</span><span class="p">)</span>
<span class="n">mask_input</span> <span class="o">=</span> <span class="n">design_mask</span><span class="p">(</span><span class="n">design_input</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mask_input</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greys_r&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Loss-Functions">Loss Functions<a class="anchor-link" href="#Loss-Functions"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="mse" class="doc_header"><code>mse</code><a href="https://github.com/flaport/inverse_design/tree/masterinverse_design/optimization.py#L18" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>mse</code>(<strong><code>x</code></strong>, <strong><code>y</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="huber_loss" class="doc_header"><code>huber_loss</code><a href="https://github.com/flaport/inverse_design/tree/masterinverse_design/optimization.py#L22" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>huber_loss</code>(<strong><code>x</code></strong>, <strong><code>y</code></strong>, <strong><code>delta</code></strong>=<em><code>0.5</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Optimization">Optimization<a class="anchor-link" href="#Optimization"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>the loss function defines what we're optimizing.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">loss_fn</span><span class="p">(</span><span class="n">latent</span><span class="p">,</span> <span class="n">brush</span><span class="p">,</span> <span class="n">target_mask</span><span class="p">):</span>
    <span class="n">latent_t</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">latent</span><span class="p">,</span> <span class="n">brush</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">huber_loss</span><span class="p">(</span><span class="n">latent_t</span><span class="p">,</span> <span class="n">target_mask</span><span class="p">)</span>

<span class="n">loss_fn</span><span class="p">(</span><span class="n">latent_input</span><span class="p">,</span> <span class="n">brush_input</span><span class="p">,</span> <span class="n">mask_target</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray(0.31569153, dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>using jax, it's easy to get the gradient function.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">grad_fn</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">,</span> <span class="n">argnums</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>let's use an Adam optimizer</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">init_fn</span><span class="p">,</span> <span class="n">update_fn</span><span class="p">,</span> <span class="n">params_fn</span> <span class="o">=</span> <span class="n">adam</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">init_fn</span><span class="p">(</span><span class="n">latent_input</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>this is the optimization step:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">step_fn</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">brush</span><span class="p">,</span> <span class="n">mask_target</span><span class="p">):</span>
    <span class="n">latent</span> <span class="o">=</span> <span class="n">params_fn</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">latent</span><span class="p">,</span> <span class="n">brush</span><span class="p">,</span> <span class="n">mask_target</span><span class="p">)</span>
    <span class="n">grads</span> <span class="o">=</span> <span class="n">grad_fn</span><span class="p">(</span><span class="n">latent</span><span class="p">,</span> <span class="n">brush</span><span class="p">,</span> <span class="n">mask_target</span><span class="p">)</span>
    <span class="n">optim_state</span> <span class="o">=</span> <span class="n">update_fn</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">grads</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">loss</span><span class="p">,</span> <span class="n">optim_state</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>we can now loop over the optimization:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">range_</span> <span class="o">=</span> <span class="n">trange</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">range_</span><span class="p">:</span>
    <span class="n">loss</span><span class="p">,</span> <span class="n">state</span> <span class="o">=</span> <span class="n">step_fn</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">brush_input</span><span class="p">,</span> <span class="n">mask_target</span><span class="p">)</span>
    <span class="n">range_</span><span class="o">.</span><span class="n">set_postfix</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">loss</span><span class="p">))</span>
<span class="n">latent_input</span> <span class="o">=</span> <span class="n">params_fn</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mask_target</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greys_r&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">transform</span><span class="p">(</span><span class="n">latent_input</span><span class="p">,</span> <span class="n">brush_input</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greys_r&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATwAAAD8CAYAAADqmhgGAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAbLklEQVR4nO3dfaxd1X3m8e/DtW/ABkr8AjgG10xljYaJGifjkFRUU5iEyFjpOIyGCHdEmDatk1EsNVU1KiJSg1SNhNImmVZlYJzEgkgJlFFCsTpugKCOaFOBsJF5C6G41ARjx/a1HYzBYK79mz/OvuTcc85ee5/3l/18pKN79l77Zd19z/2dtfZeL4oIzMyq4KxhZ8DMbFAc8MysMhzwzKwyHPDMrDIc8MysMhzwzKwyHPDMrG8kbZN0SNKzOemS9BeS9kh6WtKH6tLWS3ohS7u5F/lxwDOzfroLWJ9IvxZYk702A3cASJoCbs/SLwc2Sbq828w44JlZ30TEo8DRxCYbgW9HzWPABZJWAFcAeyLipYg4BdybbduVBd0eoB3Lli2L1atXD/KUXUn1Qnnqqady006fPt2P7AyFpNw099IpdtZZ+WWKtWvX5qalrnvK3r17mZmZ6WznzPr162NmZqbUtrt27XoOeKtu1daI2NrG6VYCr9Qt78vWtVr/kTaO21JXAU/SeuDPgSngmxFxW2r71atX8/jjj7dMS30wsnN1mMt8Rf+ws7OzuWnLly/PTTtx4kRu2pkzZ4ozlmNqaqqj4xZd29S+qXOmrk+RToNl0edgGEE4ladFixblpv3oRz/KTXvPe97TUV4+/OEPd7RfvZmZGXbu3FlqW0lvRcS6Lk7X6uJFYn1XOg54dXXsa6hF3yckbY+IH3ebKTMbrgF+cewDLq1bvgTYD0znrO9KN/fw+lLHNrNK2Q58Jnta+1HgtYg4ADwBrJF0maRp4IZs2650U6UtVceWtJna0xdWrVrVxenMbFB6VcKTdA9wFbBM0j7gy8DC7Bx3AjuADcAe4E3gt7O0WUlbgAep3TLbFhHPdZufbgJeqTp2dgNzK8C6det8l9tsDPQq4EXEpoL0AL6Qk7aDWkDsmW6qtHl1bzOzkdRNCe/dOjbwKrU69m8V7ZT3xLAfT2G79c477+SmnTx5MjetX81SOn0q2s2T4W727VTqqfIoNoVJ5enss8/OTUs9iR3m/0NEjOR17oWOA16/6thmZv3SVTu8ftSxzWz4JrWE565lZlYZA+1aZmbjYVJLeA54ZtZkUgOeq7RmVhku4ZlZk0kt4VU64BW1l7vsssty006dOtXr7FhmGG3/urF48eLctH379uWmjWLb00lX6YBnZs0mueGx7+GZWWW4hGdmTVzCMzMbcy7hmVkTl/DMzMbcxJfwumnicOzYsR7mxHphGJP4TE9PJ9OPHDmSm9bpZDzDNqklvIkPeGbWvkkNeK7SmllfSVov6QVJeyTd3CL9v0vanb2elXRa0pIsba+kZ7K0cnNHJriEZ2bz9LLhcZnpXCPiT4E/zbb/TeAPIuJo3WGujohyM4MXcAnPzPqp3elcNwH39CszDnhm1mSulFf0KqHVdK4rW20oaRGwHvhefVaAhyTtyqZ87YqrtGbWpI0q7bKGe2tbs6lZ55SazjXzm8CPGqqzV0bEfkkXAg9L+klEPFo2c40GHvDyLmS/Ro5IHbfojzo1NZWblprRrF+6+V1GzaiNFJLKT2oWNUh/TsZVG5+nmYhYl0hvZzrXG2iozkbE/uznIUn3U6sidxzwXKU1s356dzpXSdPUgtr2xo0k/RLwG8ADdesWSzpv7j3wCeDZbjLjKq2ZzdPLp7R507lK+nyWfme26XXAQxHxRt3uFwH3Z6XvBcB3I+IH3eTHAc/MmvTyFkmr6VzrAt3c8l3AXQ3rXgI+0LOM4IBnZi2M2z3hshzwzKyJA56ZVYYDXo+MUnOEoj/queeem5v21ltv9To7hc4555zctNSoMN00m0hNdFTUNCd1fUdtop5UXhcuXDjAnFg/dRXwJO0FXgdOA7MF7XHMbAxM8iQ+vSjh9axjr5mNBgc8M6uMSQ143fa0KOzYK2mzpJ2Sdh4+fLjL05nZIPRw8ICR0m0Jr7Bjb9aReCvAunXrxu8KmVXQOAazMroq4dV37AXmOvaamY2kjgNePzr2mtnwla3OjmMpsJsqbUcdezu9SJ2230vtt2BB+td/+eWXc9NWrVqVm3bq1KnctKK2a6lZrn72s5/lpqXa2hW1w0u1tUtZunRpMv2NN95Ipo+LouGhhtGmsNO/WVnjGMzK6Djg9aNjr5mNBgc8M6sMBzwzq4xJDXge8djMKsMlPDObZ1yfwJbhgGdmTUZtNJtemfhZy1KKmhssWrQoN+3VV1/t+Lid5imV1s31Sx039U1/6NCh5HGXLFmSm3by5MnijI2IN998M5k+ip9da81Xzcya9LLhsaT1kl6QtEfSzS3Sr5L0mqTd2euPy+7bLldpzaxJr+7hSZoCbgeuoTZH7ROStkfEjxs2/fuI+GSH+5bmEp6Z9dMVwJ6IeCkiTgH3AhsHsG9LDnhmNk+bfWmXzQ3/lr0ah4lbCbxSt7wvW9fo1yQ9JelvJf3bNvctzVVaM2vSxlPamYKpHVo90WmsLz8J/HJEnJC0AfhrYE3JfdviEp6ZNenhQ4t9wKV1y5cA+xvOdTwiTmTvdwALJS0rs2+7Kj1rWTdSo5pMkm5Gm5mens5NG6dmKUWf2Un5TNfrYcPjJ4A1ki4DXgVuAH6rfgNJFwMHIyIkXUGtIHYE+HnRvu1yldbM5ullT4uImJW0BXgQmAK2RcRzkj6fpd8J/Gfgv0maBU4CN0QtAy337SY/Dnhm1ldZNXVHw7o7697/JfCXZffthgOemTVxX1ozqwz3pTWzynAJz8wqwcNDDcAkPtqfdEX/FLOzswPKSX8VTYI0DP3+f3HAM7PKcMAzs8pwwDOzynDAM7NK8EMLM6sUBzwzqwwHPDOrjMoGPEnbgE8ChyLi/dm6JcBfAauBvcCnI+JYmRO6vd3kKPpbnjp1akA56a/Tp08n00exnV43ImJiu5aVGQD0LmB9w7qbgUciYg3wSLZsZjbSCgNeRDwKHG1YvRG4O3t/N/Cp3mbLzIapl9M0jpJO7+FdFBEHACLigKQL8zbMJvXYDLBq1aoOT2dmgzSOwayMvs9pERFbI2JdRKxbvnx5v09nZj0wqSW8TgPeQUkrALKfh3qXJTMbNge8+bYDN2XvbwIe6E12zGzY5p7SlnmVIWm9pBck7ZHU9IBT0n+R9HT2+kdJH6hL2yvpGUm7Je3s9ncr0yzlHuAqahPu7gO+DNwG3Cfps8BPgevLnnCUmqUUfUONUl5H0Vlnpb8vU7OavfPOO73OTt8UNUuZRL0qvUmaAm4HrqE27eITkrZHxI/rNvsX4Dci4pika4GtwEfq0q+OiJle5Kcw4EXEppykj/UiA2Y20a4A9kTESwCS7qXWyuPdgBcR/1i3/WPU5p/tC0/EbWZN2riHt0zSzrrX5oZDrQReqVvel63L81ngb+uzAjwkaVeLY7fNXcvMbJ42e1rMRMS6RHqr+0It68uSrqYW8H69bvWVEbE/a/r2sKSfZG2DO+ISnpk16eFDi33ApXXLlwD7GzeS9KvAN4GNEXFkbn1E7M9+HgLup1ZF7pgDnpk16WGzlCeANZIukzQN3ECtlce7JK0Cvg/cGBH/VLd+saTz5t4DnwCe7eb3cpXWzObp5eABETEraQvwIDAFbIuI5yR9Pku/E/hjYCnwv7KWEbNZNfki4P5s3QLguxHxg27yM/EBL/Ut1M2sW6kmK6njLly4MHnOcVLUtGRSZi0rkroO09PTA8xJ7/SyUXFE7AB2NKy7s+797wK/22K/l4APNK7vxsQHPDNr3zj2oijDAc/MmjjgmVklRMTE9i5xwDOzJi7hmVllOOCZWWU44PVI3oXs18gkqXsRRfcpVq7M7/J39GjjqPe/cP755+emHT58OHnO1HVIjU6S+oB2M8lMqsnFxRdf3PG+46Ton//CC3MH/ObQofyhIjv9W0N+k59eBKpJnsTHJTwza+KAZ2aV4SqtmVXCuA7fXoYDnpk1cZXWzCrDJTwzqwwHPDOrBHct65GI4O23326dkcQMV5Bus5S637BkyZLctKI/6ltvvZWblvoGfO2113LTioYLSrWZS7XvO3DgQG5aUZuuVHu5pUuX5qadOHEiedxJUXQ/K/X3vuCCC3LTUsNnFf0/nH322S3XHz9+PLlfWS7hmVkl+CmtmVWKA56ZVcakBjxP4mNmTXo4axmS1kt6QdIeSTe3SJekv8jSn5b0obL7tssBz8zmmRs8oBcBT9IUcDtwLXA5sEnS5Q2bXQusyV6bgTva2LctDnhm1qSH0zReAeyJiJci4hRwL7CxYZuNwLej5jHgAkkrSu7bloHew3vqqae45JJLWqadPHkyuW+q6USqecm4dZFJ/S7Hjh3LTTv33HNz04pmSkt9cPOaEVk5RZ/rPEVDa3V63LLa+L9ZJmln3fLWiNhat7wSeKVueR/wkYZjtNpmZcl921IY8CRtAz4JHIqI92frbgV+D5gb3O2WbCo2MxtzbTZLmcnmkM3TqgFt48Hztimzb1vKVGnvAta3WP/1iFibvRzszCZID6u0+4BL65YvAfaX3KbMvm0pDHgR8SiQP7yvmU2cHj6lfQJYI+kySdPADcD2hm22A5/JntZ+FHgtIg6U3Lct3dzD2yLpM8BO4A8jouUNJkmbqT15KeziZGajoVft8CJiVtIW4EFgCtgWEc9J+nyWfiewA9gA7AHeBH47tW83+ek04N0B/Am1+vSfAF8FfqfVhtkNzK0ACxYsmMzWjGYTpNddy7JbXjsa1t1Z9z6AL5TdtxsdBbyIODj3XtI3gL/pVYbMbPgmtadFRwFP0oqsjg1wHfBsmf1Onz7NkSNHOjmlFUiNvJFKM2ulsgFP0j3AVdTa2+wDvgxcJWkttSrtXuBz/cuimQ1aZQNeRGxqsfpbfciLmY0ADwBqZpVS2RKemVWPA56ZVYYDnplVgod4N7NKccAzGwOpWeFSM8KlpGavg8kMDuM2rFpZDnhm1mQSgzg44JlZg7kh3ieRA56ZNXEJz8wqwwHPzCrBVVozqxSX8GyeVBOH1LfjMD5IUqu5UH5hnD7cRb/LG2+80dG+qWtw3nnnJc9Z1GxlHI3TZ6IdDnhm1mRSA54nmTCzJj2ctSyXpCWSHpb0YvbzvS22uVTS30l6XtJzkn6/Lu1WSa9K2p29NhSd0wHPzOYpG+x6UAq8GXgkItYAj2TLjWapTRL2b4CPAl+QdHldelvTxTrgmVmT06dPl3p1aSNwd/b+buBTjRtExIGIeDJ7/zrwPLCy0xM64JlZkzZKeMsk7ax7bW7jNBfNzY2T/bwwtbGk1cAHgcfrVm+R9LSkba2qxI380MLM5mmzujoTEevyEiX9ELi4RdKX2smTpHOB7wFfjIjj2erS08XOGXjAy2saMG5PhVLF+aKmEympyco7bQw6btf2nHPOyU07fvx4bhqkmwt1+nd57bXXkukXXHBBbtrJkyc7OmeRvM9JrxoM93Ai7o/npUk6ODcDoqQVwKGc7RZSC3bfiYjv1x277eliXaU1syYDemixHbgpe38T8EDjBqp9S30LeD4ivtaQtqJusdR0sQ54ZtZkQAHvNuAaSS8C12TLSHqfpLknrlcCNwL/oUXzk69IekbS08DVwB8UndD38MxsnkH1pY2II8DHWqzfD2zI3v8D0PJeRETc2O45HfDMrMm43fctywHPzJo44JlZZTjg9cBZZ53F4sWLW6bNzs4m902NSDFqf5xu8jOp45A1So1AMjMzk5u2YMHgv6OLmrN00wypU/3+nIza/1SvFD6lzeu8W6bjr5mNn7mHFmVe46ZMs5S8zrtlOv6a2RgaULOUgSsMeInOu4Udf81sPE1qwGvrhkhD5915HX8ltez4m3Um3py97yqzZjYY4xjMyigd8Bo775YNXhGxFdgKMDU1NZlX0WyCjGvprYxSXctyOu8enOvLlur4a2bjZ1KrtGWe0uZ13i3s+Gtm42lSn9KWqdLOdd59RtLubN0t1Dr63ifps8BPgeuLDrR27Voee+yxlmlFF2/p0qW5aamZqqx/UkNZAbltLgGOHDmSm7Zw4cKO89QPqSGnJtU4lt7KKAx4qc67tOj4a2bjbVyrq2W4a5mZNXHAM7PKcMAzs0qIiF7MSDaSHPDMrIlLeGZWGQ54PSCp4+F9UjNHpYYaevvtt3PTxrEd0Sgpun6pYZ5GrelJShU/J4MIeJKWAH8FrAb2Ap+OiGMtttsLvA6cBmbnpoUsu389T+JjZk0G1NOinRGXro6ItQ1z4LY9YpMDnpnNUzbY9SDgdTviUtv7+x6emTVpoxq/TNLOuuWt2YAhZZQacQkI4CFJAfzvuuOX3f9dDnhm1qSN0ttMQzVzHkk/BC5ukfSlNrJzZUTszwLaw5J+EhGPtrH/uxzwzGyeXs5LGxEfz0uTdFDSiqx0ljviUjZPLRFxSNL9wBXAo2QjNhXtX8/38MysyYDu4RWOuCRpsaTz5t4DnwCeLbt/o5Ep4RUNKJoaseLEiRO5aakW4+eff37ynKmZ0gzOOeecZHrRaCrjoqgp1dGjR3PTli1blpuW+twO24Ca4rQccUnS+4BvRsQG4CLg/iw+LAC+GxE/SO2fMjIBz8xGw6BGS4mII7QYcSmrwm7I3r8EfKCd/VMc8MysifvSmllluGuZmVVCL5/SjhoHPDNr4hKemVWGS3gjLNX8IZWWGoEF0k0KUk1W3nnnneRxJ8X09HQyfVJLCY1S1yE1Yszy5ctz01Kj/EB+k6BeNHVxldbMKsUBz8wqY1JL5w54ZjaPq7RmViku4ZlZZTjgmVkleJpGM6uUyt7Dk3Qp8G1qo5aeoTaE859LuhX4PeBwtuktEbGjxPE6z22PFbUj+/nPf56bNjs7m5u2dOnS3LSi9lWpqkSnwy0VfVsvWrSoo3MeOpQeb7HTGeq6kbp+/frspY6b+oylPl9FASfv83fllVcm9yurylXaWeAPI+LJbCC+XZIeztK+HhF/1r/smdmgVfopbTZJxtxEGa9Leh5Y2e+MmdnwTGoJr606kqTVwAeBx7NVWyQ9LWmbpPfm7LNZ0k5JOw8fPtxqEzMbMQMa4n3gSgc8SecC3wO+GBHHgTuAXwHWUisBfrXVfhGxNSLWRcS6VN9BMxsNc09py7zGTamAJ2khtWD3nYj4PkBEHIyI0xFxBvgGtZmEzGwCnDlzptSrG5KWSHpY0ovZz6ZaoqR/LWl33eu4pC9mabdKerUubUPROQsDnmqPoL4FPB8RX6tbv6Jus+v4xUxCZjbmBlSlvRl4JCLWAI9ky435eCEi1kbEWuDfAW8C99dt8vW59DKtRMo8pb0SuBF4RtLubN0twCZJa6nNCr4X+FyJY+VepFFqrjIn1SSj0+YGRR+STq9DN80xOq2aFDU7GcW/6aClrkEqragJUt6+vbjmA7w/txG4Knt/N/D/gD9KbP8x4J8j4uVOT1jmKe0/AK2uYmE0NbPxNKBmKRdlrUDIJtO+sGD7G4B7GtZtkfQZYCe15nPHUgeYjIlDzayn2riHt2yuFUb22lx/HEk/lPRsi9fGdvIjaRr4j8D/qVtd6sFpPXctM7N52qzSzkTEusSxPp6XJumgpBVZ6W4FkOq6cy3wZEQcrDv2u+8lfQP4m6LMuoRnZk0G9NBiO3BT9v4m4IHEtptoqM528uDUJTwzazKge3i3AfdJ+izwU+B6AEnvA74ZERuy5UXANTQ/GP1Kuw9OHfDMrMkgntJGxBFqT14b1+8HNtQtvwk0jcgRETe2e86BB7wqNFVINSkYxd9/3PKbMm757dTU1FTfjj2u3cbKcAnPzJpUdrQUM6sel/DMrBIqPR6emVWPS3hmVhkOeGZWGQ54Vtq4NY0Yt/xafwOS7+GZWaU44JlZZbhKa2aV4YBnZpXgrmVmVim+h2dmleGAZ2aV4CptD+V9cxTN0pTS6Yxd3cwg1ukHol+zlg1DN3lNXYduZmAbhlRpqNNZy4bNAc/MKsMBz8wqwwHPzCohIjqenH3UedYyM2syiFnLJF0v6TlJZyTlTvUoab2kFyTtkXRz3folkh6W9GL2871F53TAM7MmA5qm8VngPwGP5m0gaQq4ndq8tJcDmyRdniXfDDwSEWuAR7LlJAc8M2syiIAXEc9HxAsFm10B7ImIlyLiFHAvsDFL2wjcnb2/G/hU0TkHeg9v165dM1NTUy/XrVoGzAwyDwWcn7RRyw+MXp6GnZ9f7sExHqT2e5RxtqSddctbI2JrD/IwZyXwSt3yPuAj2fuLIuIAQEQckHRh0cEGGvAiYnn9sqSdEZFbdx805ydt1PIDo5enUctPJyJifa+OJemHwMUtkr4UEQ+UOUSLdR0XLf2U1sz6JiI+3uUh9gGX1i1fAuzP3h+UtCIr3a0ADhUdzPfwzGyUPQGskXSZpGngBmB7lrYduCl7fxNQWGIcdsDrZV2/F5yftFHLD4xenkYtPyNL0nWS9gG/BvxfSQ9m698naQdARMwCW6jdV3weuC8inssOcRtwjaQXgWuy5fQ5J7VFtZlZo2GX8MzMBsYBz8wqYygBL6+ryLBI2ivpGUm7G9oUDTIP2yQdkvRs3bq2u870OT+3Sno1u067JW0YYH4ulfR3kp7PuiP9frZ+KNcokZ+hXSMrNvB7eFlXkX+idpNxH7WnMJsi4scDzcj8PO0F1kXE0BqMSvr3wAng2xHx/mzdV4CjEXFb9sXw3oj4oyHm51bgRET82SDy0JCfFcCKiHhS0nnALmot6/8rQ7hGifx8miFdIys2jBJeqqtIZUXEo8DRhtVtd53pc36GJiIORMST2fvXqT2xW8mQrlEiPzbChhHwWnUVGfYHJYCHJO2StHnIeak3r+sMUNh1ZgC2SHo6q/IOrIpdT9Jq4IPA44zANWrID4zANbLWhhHwetpVpEeujIgPURuR4QtZdc6a3QH8CrAWOAB8ddAZkHQu8D3gixFxfNDnL5GfoV8jyzeMgJfqKjIUEbE/+3kIuJ9atXsUHMzuFc3dMyrsOtNPEXEwIk5HxBngGwz4OklaSC24fCcivp+tHto1apWfYV8jSxtGwEt1FRk4SYuzm85IWgx8gto4XaOg7a4z/TQXWDLXMcDrpNqMN98Cno+Ir9UlDeUa5eVnmNfIig2lp0X2qP5/AlPAtoj4HwPPxC/y8q+oleqgNpjCd4eRH0n3AFdRG5bnIPBl4K+B+4BVwE+B6yNiIA8ScvJzFbWqWgB7gc/N3T8bQH5+Hfh74BlgbpqwW6jdNxv4NUrkZxNDukZWzF3LzKwy3NPCzCrDAc/MKsMBz8wqwwHPzCrDAc/MKsMBz8wqwwHPzCrj/wMnEp5btjBiDAAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">huber_loss</span><span class="p">(</span><span class="n">transform</span><span class="p">(</span><span class="n">latent_input</span><span class="p">,</span> <span class="n">brush_input</span><span class="p">),</span> <span class="n">mask_target</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray(0.00067599, dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

<script type="application/vnd.jupyter.widget-state+json">
{"state": {"02dee5eba0ab42f68fa6f007912f8397": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "0aa9e1e13a3942d49fcb924c825ccdc8": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_73c01f3e892a4d5e85b20f4a1f1dd8b0", "max": 1000.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_64075c140c004d978b47524097bd4f65", "value": 1000.0}}, "301462ba73004cbea0314b8c5684a691": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3ab1a6e68ac14571bafbf1a19c50d82b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_5e14c35944f84a99aee8921d75514e3a", "placeholder": "\u200b", "style": "IPY_MODEL_656fd954242743169ab9a94bb7d1b17b", "value": " 1000/1000 [00:15&lt;00:00, 67.90it/s, loss=0.000677]"}}, "58fbddd9e61848349d5f8ee53c4977cc": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_794e2d80bc2349868736d8cf98b10b5e", "IPY_MODEL_0aa9e1e13a3942d49fcb924c825ccdc8", "IPY_MODEL_3ab1a6e68ac14571bafbf1a19c50d82b"], "layout": "IPY_MODEL_301462ba73004cbea0314b8c5684a691"}}, "5e14c35944f84a99aee8921d75514e3a": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "64075c140c004d978b47524097bd4f65": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "656fd954242743169ab9a94bb7d1b17b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "73c01f3e892a4d5e85b20f4a1f1dd8b0": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "794e2d80bc2349868736d8cf98b10b5e": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_b2e2363f48f14d8aafdee32cb8c0be94", "placeholder": "\u200b", "style": "IPY_MODEL_02dee5eba0ab42f68fa6f007912f8397", "value": "100%"}}, "b2e2363f48f14d8aafdee32cb8c0be94": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}}, "version_major": 2, "version_minor": 0}
</script>

